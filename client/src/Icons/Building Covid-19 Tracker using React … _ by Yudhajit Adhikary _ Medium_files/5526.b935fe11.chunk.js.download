(self.webpackChunklite=self.webpackChunklite||[]).push([[5526],{14856:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(67294);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var s=r.createElement("rect",{x:26.25,y:9.25,width:.5,height:6.5,rx:.25,strokeWidth:.5}),l=r.createElement("rect",{x:29.75,y:12.25,width:.5,height:6.5,rx:.25,transform:"rotate(90 29.75 12.25)",strokeWidth:.5}),o=r.createElement("path",{d:"M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5",strokeLinecap:"round"}),u=r.createElement("path",{d:"M11.5 14.5L19 20l4-3",strokeLinecap:"round"});const a=function(e){return r.createElement("svg",i({width:38,height:38,viewBox:"0 0 38 38",fill:"none"},e),s,l,o,u)}},99033:(e,t,n)=>{"use strict";n.d(t,{DI:()=>C,nj:()=>N,oT:()=>T});var r=n(59713),i=n.n(r),s=n(63038),l=n.n(s),o=n(28655),u=n.n(o),a=n(82492),c=n.n(a),d=n(71439),m=n(46829),b=n(67294),p=n(53976),v=n(81474),w=n(32589),f=n(95760),h=n(51512),g=n(85277);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(){var e=u()(["\n  mutation fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe(\n    $userId: ID!\n    $shouldSubscribeCurrentUser: Boolean\n  ) {\n    fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe(\n      userId: $userId\n      shouldSubscribeCurrentUser: $shouldSubscribeCurrentUser\n    ) {\n      __typename\n      ...useNewsletterV3Subscription_newsletterV3\n    }\n  }\n  ","\n"]);return V=function(){return e},e}function y(){var e=u()(["\n  mutation unsubscribeNewsletterV3($newsletterV3Id: ID!) {\n    unsubscribeNewsletterV3(newsletterV3Id: $newsletterV3Id)\n  }\n"]);return y=function(){return e},e}function I(){var e=u()(["\n  mutation subscribeNewsletterV3($newsletterV3Id: ID!, $shouldRecordConsent: Boolean) {\n    subscribeNewsletterV3(\n      newsletterV3Id: $newsletterV3Id\n      shouldRecordConsent: $shouldRecordConsent\n    )\n  }\n"]);return I=function(){return e},e}function x(){var e=u()(["\n  fragment useNewsletterV3Subscription_newsletterV3_viewerEdge on NewsletterV3 {\n    viewerEdge {\n      id\n      isSubscribed\n    }\n  }\n"]);return x=function(){return e},e}function k(){var e=u()(["\n  fragment useNewsletterV3Subscription_user on User {\n    id\n    username\n    newsletterV3 {\n      ...useNewsletterV3Subscription_newsletterV3\n    }\n  }\n  ","\n"]);return k=function(){return e},e}function _(){var e=u()(["\n  fragment useNewsletterV3Subscription_newsletterV3 on NewsletterV3 {\n    id\n    type\n    slug\n    name\n    collection {\n      slug\n    }\n    user {\n      id\n      name\n      username\n      newsletterV3 {\n        id\n      }\n    }\n  }\n"]);return _=function(){return e},e}var C=(0,d.Ps)(_()),N=(0,d.Ps)(k(),C),M=((0,d.Ps)(x()),(0,d.Ps)(I())),U=(0,d.Ps)(y()),O=(0,d.Ps)(V(),C),T=function(e){var t=e.newsletterV3,n=e.creator,r=e.newsletterName,i=t||{},s=i.id,o=i.type,u=i.slug,a=i.collection,d=(null==t?void 0:t.user)||n,S=null!=r?r:null==t?void 0:t.name,V=b.useState(!1),y=l()(V,2),I=y[0],x=y[1],k=(0,v.T)({newsletterSlug:u,collectionSlug:null==a?void 0:a.slug,username:null==d?void 0:d.username}),_=k.viewerEdge,C=k.loading,T=(0,p.VB)({name:"enable_auto_follow_on_subscribe",placeholder:!1}),P=b.useState(!1),A=l()(P,2),D=A[0],R=A[1];b.useEffect((function(){R(!(null==_||!_.isSubscribed))}),[null==_?void 0:_.isSubscribed]);var L=(0,f.Av)(),B=(0,h.Qi)(),F=(0,g.w)();I&&L.event("newsletterV3.subscribe.error",{newsletterV3Id:s});var $=function(e,t,n){if(n){var r={id:"User:".concat(null==d?void 0:d.id),fragment:N,fragmentName:"useNewsletterV3Subscription_user"},i=e.readFragment(r);e.writeFragment(E(E({},r),{},{data:E(E({},i),{},{newsletterV3:n})}))}if(_){var s=e.readQuery({query:v.p,variables:{newsletterSlug:u,collectionSlug:null==a?void 0:a.slug,username:null==d?void 0:d.username}}),l=c()({},s,{newsletterV3:{viewerEdge:{isSubscribed:t}}});e.writeQuery({query:v.p,variables:{newsletterSlug:u||"",collectionSlug:null==a?void 0:a.slug,username:null==d?void 0:d.username},data:l})}if(t&&T){var o=e.readQuery({query:w.J4,variables:{userId:null==d?void 0:d.id}}),m=c()({},o,{user:{viewerEdge:{isFollowing:!0}}});e.writeQuery({query:w.J4,variables:{userId:(null==d?void 0:d.id)||""},data:m})}},j=(0,m.useMutation)(M,{onCompleted:function(e){var t=e.subscribeNewsletterV3;x(!t),t&&(L.event("newsletterV3.subscribeClicked",{newsletterV3Id:s,source:B}),R(!0))},update:function(e){$(e,!0)}}),W=l()(j,1)[0],G=(0,m.useMutation)(U,{onCompleted:function(e){var t=e.unsubscribeNewsletterV3;x(!t),t&&(R(!1),F({duration:"NEXTPAGE",toastStyle:"NEWSLETTER_UNSUBSCRIBE",extraParams:{newsletterName:S||null,newsletterType:o||null,unsubscribeFn:function(){return R(!1)}}}))},update:function(e){$(e,!1)}}),z=l()(G,1)[0],Q=(0,m.useMutation)(O,{onCompleted:function(e){var t=e.fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe;x(!t),t&&(L.event("newsletterV3.subscribeClicked",{newsletterV3Id:t.id,source:B}),R(!0))},update:function(e,t){var n,r=E({},null===(n=t.data)||void 0===n?void 0:n.fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe);$(e,!0,r)}}),H=l()(Q,1)[0];return{isSubscribed:D,hasError:I,setSubscribe:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];x(!1),e&&!t&&null!=n&&n.id?H({variables:{userId:null==n?void 0:n.id,shouldSubscribeCurrentUser:!0}}):e&&null!=t&&t.id?W({variables:{newsletterV3Id:null==t?void 0:t.id,shouldRecordConsent:r}}):null!=t&&t.id?z({variables:{newsletterV3Id:null==t?void 0:t.id}}):x(!0)},loading:C}}},96210:(e,t,n)=>{"use strict";n.d(t,{w:()=>i,f:()=>s});var r=n(67294),i=r.createContext({isWorkingPreview:!1}),s=function(){return r.useContext(i)}},81474:(e,t,n)=>{"use strict";n.d(t,{T:()=>u,p:()=>a});var r=n(28655),i=n.n(r),s=n(46829),l=n(71439);function o(){var e=i()(["\n  query NewsletterV3ViewerEdge($newsletterSlug: ID!, $collectionSlug: ID, $username: ID) {\n    newsletterV3(\n      newsletterSlug: $newsletterSlug\n      collectionSlug: $collectionSlug\n      username: $username\n    ) {\n      ... on NewsletterV3 {\n        id\n        viewerEdge {\n          id\n          isSubscribed\n        }\n      }\n    }\n  }\n"]);return o=function(){return e},e}var u=function(e){var t,n=e.newsletterSlug,r=void 0===n?"":n,i=e.collectionSlug,l=e.username,o=(0,s.useQuery)(a,{variables:{newsletterSlug:r,collectionSlug:i,username:l},ssr:!1,skip:!r&&!l}),u=o.loading,c=o.error,d=o.data;return u?{loading:u}:c?{error:c}:{viewerEdge:null==d||null===(t=d.newsletterV3)||void 0===t?void 0:t.viewerEdge}},a=(0,l.Ps)(o())},68421:(e,t,n)=>{"use strict";n.d(t,{$:()=>r,o:()=>y});var r,i=n(67154),s=n.n(i),l=n(63038),o=n.n(l),u=n(6479),a=n.n(u),c=n(46829),d=n(67294),m=n(96210),b=n(76532),p=n(47089),v=n(42933),w=n(82318),f=n(80362),h=n(98024),g=n(24438),S=n(95760),E=n(6688);!function(e){e.CTA="CTA",e.DISMISSED="DISMISSED"}(r||(r={}));var V=function(e){var t=e.children,n=e.flag,i=e.text,l=e.renderFn,u=e.viewer,m=e.padding,b=void 0===m?16:m,V=e.placement,y=e.darkTheme,I=a()(e,["children","flag","text","renderFn","viewer","padding","placement","darkTheme"]),x=(0,S.Av)(),k=d.useState(!1),_=o()(k,2),C=_[0],N=_[1],M=(0,c.useMutation)(p.a,{variables:{userId:u.id,flag:n}}),U=o()(M,1)[0],O=(0,E.I)(),T=d.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.DISMISSED;N(!1),U(),x.event("user.dismissedPopover",{flag:n,action:e})}),[C]);d.useEffect((function(){return N(!0)}),[]);var P=d.useCallback((function(){return d.createElement(v.x,{minWidth:"200px",padding:(0,g.a)(b)},d.createElement(h.F,{scale:"S",color:"WHITE"},i),d.createElement(v.x,{marginTop:"8px"},d.createElement(h.F,{scale:"S",color:y?"WHITE":void 0},d.createElement(w.r,{onClick:function(){return T(r.DISMISSED)}},d.createElement("span",{className:O(f.u)},"Got it")))))}),[T,b,i]);return d.createElement(f.J,s()({disablePortalOverlay:!0,hide:T,isVisible:C,popoverRenderFn:l?l(T):P,darkTheme:!0,placement:V},I),t)},y=function(e){var t=e.children,n=e.flag,r=e.isVisible,i=void 0===r||r,l=a()(e,["children","flag","isVisible"]),o=(0,m.f)().isWorkingPreview,u=(0,b.H)().value;return o||null!=u&&u.dismissableFlags.includes(n)||!u||!i?t:d.createElement(V,s()({flag:n,viewer:u},l),t)}},85526:(e,t,n)=>{"use strict";n.d(t,{X:()=>Y,w:()=>J});var r=n(28655),i=n.n(r),s=n(63038),l=n.n(s),o=n(71439),u=n(67294),a=n(46829),c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateUserPostSubscribeMembershipUpsellShownAt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userUpdatePostSubscribeMembershipUpsellShownAt"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"postSubscribeMembershipUpsellShownAt"}}]}}]}}]},d=n(53976),m=n(76532),b=n(11852),p=n(50223),v=n(42933),w=n(17614),f=n(98024),h=n(95760),g=n(51512),S=n(67297),E=n(6522),V=n(96879),y=n(27952);function I(){var e=i()(["\n  fragment SubscribedMembershipUpsellModal_user on User {\n    id\n    name\n    imageId\n    postSubscribeMembershipUpsellShownAt\n    newsletterV3 {\n      id\n    }\n  }\n"]);return I=function(){return e},e}var x="after_subscribe_membership_upsell",k=function(e){var t=e.user,n=e.isVisible,r=e.hide,i=(0,S.v9)((function(e){return e.config.authDomain})),s=(0,h.Av)(),o=(0,m.H)(),I=o.value,k=o.loading,_=!!(0,d.VB)({name:"enable_referred_memberships",placeholder:!1});u.useEffect((function(){var e;k||null!=I&&I.postSubscribeMembershipUpsellShownAt||(s.event("newsletterV3.postSubscribeMembershipUpsellViewed",{newsletterV3Id:null===(e=t.newsletterV3)||void 0===e?void 0:e.id,source:x}),N())}),[k]);var C=(0,a.useMutation)(c,{optimisticResponse:{userUpdatePostSubscribeMembershipUpsellShownAt:{__typename:"User",id:(null==I?void 0:I.id)||"",postSubscribeMembershipUpsellShownAt:(new Date).getTime()}}}),N=l()(C,1)[0];return _?u.createElement(g.cW,{source:{name:x}},u.createElement(p.v,{isVisible:n,hide:r,withCloseButton:!0,withAnimation:!0,buttonStyle:"STRONG",buttonSize:"REGULAR",cancelText:"Not now",confirmText:"Become a member",onConfirm:function(){var e,n;s.event("newsletterV3.postSubscribeMembershipUpsellClicked",{newsletterV3Id:null===(e=t.newsletterV3)||void 0===e?void 0:e.id,source:x}),n=(0,V.Rk)((0,y.c5p)(i),{subscribeToUserId:t.id,source:x}),window.location.href=n},showCancelButton:!0,isDestructiveAction:!1},u.createElement(v.x,{marginBottom:"24px"},u.createElement(b.z,{miroId:t.imageId||E.gG,alt:t.name||"",diameter:80,freezeGifs:!1})),u.createElement(v.x,{marginBottom:{xs:"8px",sm:"8px",md:"16px",lg:"16px",xl:"16px"}},u.createElement(w.F1,{scale:{xs:"S",sm:"S",md:"L",lg:"L",xl:"L"}},"Youâ€™re subscribed to get email updates. Become a member for more.")),u.createElement(v.x,{marginBottom:"32px"},u.createElement(f.F,{tag:"span",scale:{xs:"M",sm:"M",md:"L",lg:"L",xl:"L"},color:"DARKER"},"Your membership fee directly supports ",t.name," and other writers you read. Get full access to every story on Medium.")))):null},_=(0,o.Ps)(I()),C=n(99033),N=n(62181),M=n(62876),U=n(68421),O=n(55099),T=n(80362),P=n(52862),A=n(92528),D=n(6688),R=n(77180),L=n(14391),B=n(85277),F=n(8403);function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var j=u.createElement("path",{d:"M24 13l2 2 3-3.5",strokeLinecap:"round",strokeLinejoin:"round"}),W=u.createElement("path",{d:"M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5",strokeLinecap:"round"}),G=u.createElement("path",{d:"M11.5 14.5L19 20l4-3",strokeLinecap:"round"});const z=function(e){return u.createElement("svg",$({width:38,height:38,viewBox:"0 0 38 38",fill:"none"},e),j,W,G)};var Q=n(14856),H=n(51064);function q(){var e=i()(["\n  fragment UserSubscribeButton_user on User {\n    id\n    isPartnerProgramEnrolled\n    name\n    viewerEdge {\n      id\n      isFollowing\n      isUser\n    }\n    viewerIsUser\n    newsletterV3 {\n      id\n      ...useNewsletterV3Subscription_newsletterV3\n    }\n    ...useNewsletterV3Subscription_user\n    ...SubscribedMembershipUpsellModal_user\n  }\n  ","\n  ","\n  ","\n"]);return q=function(){return e},e}var Y=function(e){var t=e.user,n=e.showFirstUseToolTip,r=void 0!==n&&n,i=e.showMembershipUpsellModal,s=void 0!==i&&i,o=(0,D.I)(),a=(0,R.F)(),c=(0,m.H)(),b=c.value,p=c.loading,w=(0,H.O)(!1),E=l()(w,3),I=E[0],x=E[1],_=E[2],$=t.newsletterV3,j=(0,B.w)(),W=(0,h.Av)(),G=(0,g.Qi)(),q=(0,F.PM)(),Y=(0,C.oT)({newsletterV3:$,creator:t,newsletterName:t.name||void 0}),J=Y.isSubscribed,K=Y.hasError,X=Y.loading,Z=Y.setSubscribe,ee=u.useState(!0),te=l()(ee,2),ne=te[0],re=te[1],ie=L.T3.WRITER_SUBSCRIPTIONS_TOOLTIP,se=!(null==b||!b.dismissableFlags.includes(ie)),le=!!(0,d.VB)({name:"enable_writer_subscription_to_all_users",placeholder:!1}),oe=!!(0,d.VB)({name:"enable_referred_memberships",placeholder:!1}),ue=(0,S.v9)((function(e){return e.config.authDomain})),ae=(0,V.Rk)((0,y.c5p)(ue),{subscribeToUserId:t.id,source:G}),ce=!(null==b||!b.mediumMemberAt),de=u.useState(!1),me=l()(de,2),be=me[0],pe=me[1],ve=u.useState(!1),we=l()(ve,2),fe=we[0],he=we[1],ge=le&&!se&&r&&!!b&&!J,Se=oe&&s,Ee=(0,g.P7)(q||"").susiEntry,Ve=void 0===Ee?"":Ee,ye=["newsletter_v3_promo","writer_subscription_landing"].includes(Ve),Ie=["newsletter_v3_promo","writer_subscription_landing","subscribe_user"].includes(Ve),xe=Se&&Ie&&!(null!=b&&b.mediumMemberAt)&&J&&!t.viewerIsUser&&t.isPartnerProgramEnrolled&&!ne;u.useEffect((function(){p||re(!(null==b||!b.postSubscribeMembershipUpsellShownAt))}),[p]);var ke=(0,H.O)(!1),_e=l()(ke,3),Ce=_e[0],Ne=_e[1],Me=_e[2];if(u.useEffect((function(){xe?Ne():Me()}),[xe]),u.useEffect((function(){q&&!xe&&ye&&J&&j({duration:"NEXTPAGE",toastStyle:"NEWSLETTER_SUBSCRIBE",extraParams:{newsletterName:t.name,newsletterType:L.Rr.NEWSLETTER_TYPE_AUTHOR,unsubscribeFn:function(){return Z(!1)}}})}),[q,J]),u.useEffect((function(){if(J&&fe&&$){var e=oe&&!ce&&!!t.isPartnerProgramEnrolled;e&&W.event("newsletterV3.postSubscribeMembershipUpsellViewed",{newsletterV3Id:$.id,source:G}),pe(e),he(!1)}}),[J,fe,$]),K||t.viewerEdge.isUser)return null;var Ue=J?"OBVIOUS":"STRONG",Oe=function(e,t){return function(n){return{stroke:t?n.baseColor.background.normal:e,height:"36px",width:"36px"}}},Te=u.createElement(O.z,{loading:X,size:"COMPACT",buttonStyle:Ue,onClick:function(){var e;he(!J),b?J?Z(!1):b&&b.allowEmailAddressSharingEditorWriter?Z(!0,!1):x():null!==(e=t.newsletterV3)&&void 0!==e&&e.id?W.event("newsletterV3.subscribeClicked",{newsletterV3Id:t.newsletterV3.id,source:G}):W.event("user.LOSubscribeClicked",{targetUserId:t.id,source:G})},padding:"0"},J?u.createElement(z,{className:o(Oe(a.accentColor.fill.normal,X))}):u.createElement(Q.Z,{className:o(Oe(a.accentColor.background,X))})),Pe=function(){return u.createElement(v.x,{padding:"10px 12px",maxWidth:"175px"},u.createElement(f.F,{tag:"div",scale:"S",color:"DARKER"},u.createElement("strong",null,"You're subscribed to ",t.name,". Become a member for more.")," Get full access to every story on Medium for $5 a month."),u.createElement(v.x,{padding:"8px 0px"},u.createElement(M.a,{isButton:!0,buttonStyle:"STRONG",buttonSize:"SMALL",redirectUrl:ae,width:"150px",onClick:function(){W.event("newsletterV3.postSubscribeMembershipUpsellClicked",{newsletterV3Id:$.id,source:G})}},u.createElement(v.x,{textAlign:"center"},u.createElement(f.F,{scale:"S",color:"WHITE"},"Become a member")))))},Ae=function(e){var t=e.children;return u.createElement(T.J,{isVisible:!X&&be,hide:function(){return pe(!1)},placement:"bottom",popoverRenderFn:Pe,targetDistance:10,role:"tooltip"},t)},De=function(e){var n=e.children;return u.createElement(P.$,{isVisible:!X&&!J,hideOnClick:!0,noPortal:!0,mouseEnterDelay:500,mouseLeaveDelay:0,placement:"bottom",popoverRenderFn:function(){return u.createElement(v.x,{padding:"10px 12px",maxWidth:"166px"},u.createElement(f.F,{tag:"div",scale:"S",color:"DARKER"},"Subscribe to get an email whenever ",t.name," publishes."))},role:"tooltip",targetDistance:10},n)},Re=function(e){var t=e.children;return u.createElement(U.o,{isVisible:!X,flag:ie,targetDistance:10,text:"You can now subscribe to get stories delivered directly to your inbox.",darkTheme:!0},t)},Le=function(e){var t=e.children;return ge?u.createElement(Re,null,t):be?u.createElement(Ae,null,t):u.createElement(De,null,t)};return u.createElement(u.Fragment,null,u.createElement(Le,null,u.createElement(v.x,null,b&&u.createElement(A.Q,{onConfirm:function(){Z(!0,!0)},isVisible:I,hide:_,titleText:"Confirm your subscription to ".concat(t.name),confirmText:"Confirm now",buttonStyle:"STRONG",buttonSize:"LARGE",showCancelButton:!1,withCloseButton:!1,isDestructiveAction:!1},"When you subscribe to a writer or publication, your email address will be shared with them so they can stay in contact with you outside of Medium. Opt out any time by unsubscribing in Settings."),b?Te:u.createElement(N.R9,{operation:"register",newsletterV3:$,user:t,actionUrl:$?(0,y.Zul)($.id):(0,y.lcz)(t.id),susiEntry:"subscribe_user"},Te))),xe&&u.createElement(k,{user:t,isVisible:Ce,hide:function(){re(!0),Me()}}))},J=(0,o.Ps)(q(),C.DI,C.nj,_)}}]);
//# sourceMappingURL=https://stats.medium.build/lite/sourcemaps/5526.b935fe11.chunk.js.map